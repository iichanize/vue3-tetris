(function(){"use strict";var t={1465:function(t,n,e){var i=e(9242),o=e(3396);const s={id:"app"};function a(t,n,e,i,a,l){const r=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(r)])}var l=(0,o.aZ)({name:"App",components:{},data(){return{}},methods:{}}),r=e(89);const c=(0,r.Z)(l,[["render",a]]);var p=c,u=e(2483),m=e(7139);const h=t=>((0,o.dD)("data-v-3d171f73"),t=t(),(0,o.Cn)(),t),L=h((()=>(0,o._)("h1",null,"Vue Practice",-1))),d={id:"links"},v={id:"tetris"},g=h((()=>(0,o._)("span",null,"Tetris",-1))),w={id:"ranking"},S=h((()=>(0,o._)("span",null,"Score Ranking",-1))),y={id:"howTo"},O=h((()=>(0,o._)("span",null,"HOW TO PLAY",-1)));function _(t,n,e,i,s,a){return(0,o.wg)(),(0,o.iD)("div",null,[L,(0,o._)("div",d,[(0,o._)("div",v,[g,(0,o._)("button",{onClick:n[0]||(n[0]=(...n)=>t.moveToTetris&&t.moveToTetris(...n))},"PLAY")]),(0,o._)("div",w,[S,(0,o._)("button",{onClick:n[1]||(n[1]=(...n)=>t.moveToRanking&&t.moveToRanking(...n))},"SHOW")])]),(0,o._)("div",y,[O,(0,o._)("table",null,[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.headers,((t,n)=>((0,o.wg)(),(0,o.iD)("th",{key:n},(0,m.zw)(t),1)))),128))])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.keyConfig,((t,n)=>((0,o.wg)(),(0,o.iD)("tr",{key:n},[(0,o._)("td",null,(0,m.zw)(t.keyName),1),(0,o._)("td",null,(0,m.zw)(t.move),1)])))),128))])])])])}var f=(0,o.aZ)({name:"Top",setup(){const t=(0,u.tv)(),n=()=>t.replace({name:"Tetris"}),e=()=>t.replace({name:"Ranking"}),i=["キー","動作"],o=[{keyName:"←/→",move:"左移動 / 右移動"},{keyName:"↓",move:"高速落下"},{keyName:"↑",move:"ハードドロップ"},{keyName:"z/x",move:"左回転 / 右回転"},{keyName:"a",move:"HOLD と落下中のテトリミノの入れ替え"}];return{moveToTetris:n,moveToRanking:e,headers:i,keyConfig:o}}});const Z=(0,r.Z)(f,[["render",_],["__scopeId","data-v-3d171f73"]]);var E=Z;const C=t=>((0,o.dD)("data-v-90124848"),t=t(),(0,o.Cn)(),t),B=(0,o.uE)('<div class="arrow" data-v-90124848><div id="first" data-v-90124848>↑</div><div id="second" data-v-90124848>↑</div><div id="third" data-v-90124848>↑</div></div><div class="holdFrame" data-v-90124848></div><div class="title" id="hold" data-v-90124848>HOLD</div><div class="stockFrame" data-v-90124848></div><div class="title" id="stock" data-v-90124848>NEXT</div>',5),I={key:0,class:"end"},k={class:"message"},K=C((()=>(0,o._)("div",{class:"header"},[(0,o._)("span",null," Result ")],-1))),x={class:"body"},T={class:"footer"};function b(t,n,e,s,a,l){const r=(0,o.up)("PlayBoardLayer");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(r,{onEnding:t.ending,onScore:t.resultScore},null,8,["onEnding","onScore"]),B,t.flag?((0,o.wg)(),(0,o.iD)("div",I,[(0,o._)("div",k,[K,(0,o._)("div",x,[(0,o._)("span",null,"スコア："+(0,m.zw)(t.score),1),(0,o._)("span",null,[(0,o.Uk)("ユーザー名： "),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":n[0]||(n[0]=n=>t.userName=n)},null,512),[[i.nr,t.userName]])])]),(0,o._)("div",T,[(0,o._)("button",{onClick:n[1]||(n[1]=(...n)=>t.moveToTop&&t.moveToTop(...n))},"Topへ戻る"),(0,o._)("button",{id:"sendButton",onClick:n[2]||(n[2]=(...n)=>t.moveToRanking&&t.moveToRanking(...n))},"ランキングへ送信")])])])):((0,o.wg)(),(0,o.iD)("button",{key:1,id:"return",onClick:n[3]||(n[3]=(...n)=>t.moveToTop&&t.moveToTop(...n))},"Topへ戻る"))],64)}var M=e(4870);const N=t=>((0,o.dD)("data-v-3abde733"),t=t(),(0,o.Cn)(),t),H={class:"PlayBoardLayerRoot"},R={class:"level"},D={class:"score"},J=N((()=>(0,o._)("br",null,null,-1)));function z(t,n,e,i,s,a){const l=(0,o.up)("Block"),r=(0,o.up)("MinoLayer");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",H,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.stageState.wallList,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.id,class:"BlockElement",x:t.position.x,y:t.position.y,angle:t.angle,color:t.color},null,8,["x","y","angle","color"])))),128)),(0,o.Wm)(r,{onMap:t.getMap,onScore:t.updateScore,onLevel:t.setLevel},null,8,["onMap","onScore","onLevel"])]),(0,o._)("div",R,"Lv."+(0,m.zw)(t.level),1),(0,o._)("div",D,[(0,o.Uk)("SCORE"),J,(0,o.Uk)((0,m.zw)(t.totalScore),1)])],64)}e(7658);const A=t=>{const n=`color: ${t.color};transform: translate(${t.x}px, ${t.y}px);`;return(0,o.h)("div",{class:"BlockRoot",style:n})},P=t=>{let n=!1;return(0,o.bv)((()=>{const e=()=>{requestAnimationFrame((()=>{if(n)return;const i=t();i&&e()}))};e()})),(0,o.Jd)((()=>{n=!0})),{}};var Y=e(2482);class j{constructor(t=0,n=0){(0,Y.Z)(this,"x",void 0),(0,Y.Z)(this,"y",void 0),this.x=t,this.y=n}get length(){return Math.sqrt(this.x**2+this.y**2)}get angle(){const t=t=>t/Math.PI*180;return t(Math.atan2(this.y,this.x))}add(t){return new j(this.x+t.x,this.y+t.y)}sub(t){return new j(this.x-t.x,this.y-t.y)}times(t){return new j(this.x*t,this.y*t)}unit(t=1){const n=this.length;return new j(this.x/n*t,this.y/n*t)}limit(t=1){return this.length<=t?this:this.unit(t)}rotate(t){const n=t=>t*Math.PI/180,e=n(this.angle+t),i=this.length;return new j(Math.cos(e)*i,Math.sin(e)*i)}}class W{}(0,Y.Z)(W,"BLOCK_SIZE",40),(0,Y.Z)(W,"NAMES",["T","I","O","L","J","S","Z"]),(0,Y.Z)(W,"COLORS",{T:"138, 43, 226",I:"0, 255, 255",L:"0, 0, 255",J:"255, 165, 0",O:"255, 255, 0",S:"0, 255, 0",Z:"255, 0, 0"}),(0,Y.Z)(W,"SHAPE",{T:[new j(0,0),new j(0,-1),new j(-1,0),new j(1,0)],I:[new j(0,0),new j(-1,0),new j(1,0),new j(2,0)],L:[new j(0,0),new j(-1,0),new j(1,0),new j(1,-1)],J:[new j(0,0),new j(-1,-1),new j(-1,0),new j(1,0)],O:[new j(0,0),new j(1,0),new j(0,-1),new j(1,-1)],S:[new j(0,0),new j(-1,0),new j(0,-1),new j(1,-1)],Z:[new j(0,0),new j(-1,-1),new j(0,-1),new j(1,0)]});var F=W;const U=.25;let q=0;const X=()=>F.NAMES[Math.floor(7*Math.random())];class ${constructor(t,n,e,i,o,s){(0,Y.Z)(this,"id",q++),(0,Y.Z)(this,"position",new j(0,0)),(0,Y.Z)(this,"name",X()),(0,Y.Z)(this,"angle",360*Math.random()),(0,Y.Z)(this,"vector",new j),(0,Y.Z)(this,"force",U),(0,Y.Z)(this,"color",""),(0,Y.Z)(this,"shape",[]),(0,Y.Z)(this,"insensitiveTerms",0),this.position=new j(t,n),this.name=e,this.color=s?"rgba("+i+", "+s+")":"rgba("+i+", 1.0)",this.shape=o}update(){const t=new j(0,F.BLOCK_SIZE);this.position=this.position.add(t),this.position.y>20*F.BLOCK_SIZE&&(this.position=new j(this.position.x,20*F.BLOCK_SIZE)),this.position.y<0&&(this.position=new j(this.position.x,0))}drop(){const t=new j(0,F.BLOCK_SIZE);this.position=this.position.add(t),this.position.y>21*F.BLOCK_SIZE&&(this.position=new j(this.position.x,21*F.BLOCK_SIZE))}slideLeft(){this.position=new j(this.position.x-F.BLOCK_SIZE,this.position.y)}slideRight(){this.position=new j(this.position.x+F.BLOCK_SIZE,this.position.y)}slideUp(){this.position=new j(this.position.x,this.position.y-F.BLOCK_SIZE)}setForce(t){this.force=t}resize(t){this.position=new j(this.position.x+t,this.position.y)}}const G={class:"MinoLayerRoot"};function V(t,n,e,i,s,a){const l=(0,o.up)("Block");return(0,o.wg)(),(0,o.iD)("div",G,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.stageState.ghost,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.id,class:"BlockElement",x:t.position.x,y:t.position.y,angle:t.angle,color:t.color,scale:t.scale},null,8,["x","y","angle","color","scale"])))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.stageState.minoList,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.id,class:"BlockElement",x:t.position.x,y:t.position.y,angle:t.angle,color:t.color,scale:t.scale},null,8,["x","y","angle","color","scale"])))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.stageState.holdMino,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.id,class:"BlockElement",x:t.position.x,y:t.position.y,angle:t.angle,color:t.color,scale:t.scale},null,8,["x","y","angle","color","scale"])))),128)),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.stageState.stock,(t=>((0,o.wg)(),(0,o.j4)(l,{key:t.id,class:"BlockElement",x:t.position.x,y:t.position.y,angle:t.angle,color:t.color,scale:t.scale},null,8,["x","y","angle","color","scale"])))),128))])}const Q=(t,n)=>{const e=n=>{t?.(n)};return(0,o.bv)((()=>{const t=n??document.body;t.addEventListener("keydown",e)})),(0,o.Ah)((()=>{const t=n??document.body;t.removeEventListener("keydown",e)})),{}};var tt=(0,o.aZ)({name:"MinoLayer",components:{Block:A},props:{keyInput:{type:String,default:""}},setup(t,n){let e=(0,M.iH)("");const i=(0,M.qj)({minoList:[],map:[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],t:0,healthCheckTime:0,name:JSON.parse(JSON.stringify(F.NAMES)),holdMino:[],stock:[],ghost:[],totalScore:0,ren:0,deleteLineNum:0,level:1});let s=!1,a=!0,l=(0,M.iH)(Math.floor(.5*window.innerWidth)-5*F.BLOCK_SIZE),r=2*F.BLOCK_SIZE;const c=()=>{i.map=JSON.parse(JSON.stringify(new Array(22).fill(new Array(10).fill(0)))),i.minoList.map((t=>{i.map[(t.position.y-r)/F.BLOCK_SIZE+2][(t.position.x-l.value)/F.BLOCK_SIZE]=1}))},p=()=>{i.name.push("T"),i.name.push("I"),i.name.push("O"),i.name.push("L"),i.name.push("J"),i.name.push("S"),i.name.push("Z")},u=()=>{let t=Math.floor(Math.random()*i.name.length);0===i.name.length&&p();const n=i.name[t];return i.name.splice(t,1),n},m=()=>{let t=l.value+14*F.BLOCK_SIZE,n=20*F.BLOCK_SIZE;const e=u(),o=F.COLORS[e],s=JSON.parse(JSON.stringify(F.SHAPE[e]));for(let a=0;a<s.length;a++)i.stock.push(new $(t+s[a].x*F.BLOCK_SIZE,n+s[a].y*F.BLOCK_SIZE,e,o,s))},h=()=>{const t=l.value-5*F.BLOCK_SIZE,n=r+3*F.BLOCK_SIZE;for(let e=0;e<4;e++){let o=i.minoList.length;const s=i.minoList[o-1],a=JSON.parse(JSON.stringify(s.name)),l=F.COLORS[a],r=JSON.parse(JSON.stringify(F.SHAPE[a]));i.holdMino.push(new $(t+r[e].x*F.BLOCK_SIZE,n+r[e].y*F.BLOCK_SIZE,a,l,r)),i.minoList.splice(o-1,1)}if(4!==i.holdMino.length){const t=i.holdMino[0];let n=l.value+4*F.BLOCK_SIZE,e=1*F.BLOCK_SIZE;const o=JSON.parse(JSON.stringify(t.name)),s=F.COLORS[o],a=JSON.parse(JSON.stringify(F.SHAPE[o]));for(let l=0;l<4;l++)i.minoList.push(new $(n+a[l].x*F.BLOCK_SIZE,e+a[l].y*F.BLOCK_SIZE,o,s,a)),i.holdMino.shift()}else L(),d()},L=()=>{let t=l.value+4*F.BLOCK_SIZE,n=1*F.BLOCK_SIZE,e=i.stock[0].name;const o=JSON.parse(JSON.stringify(F.SHAPE[e])),s=F.COLORS[e];m();for(let a=0;a<o.length;a++)i.minoList.push(new $(t+o[a].x*F.BLOCK_SIZE,n+o[a].y*F.BLOCK_SIZE,e,s,o)),i.stock.shift()},d=()=>{i.stock.map(((t,n)=>{t.position=new j(t.position.x,(4+F.SHAPE[t.name][n%4].y+3*Math.floor(n/4))*F.BLOCK_SIZE)}))},v=t=>{let n=t.length;return!(n<4)&&(t[t.length-1].position.y===21*F.BLOCK_SIZE||t[t.length-2].position.y===21*F.BLOCK_SIZE||t[t.length-3].position.y===21*F.BLOCK_SIZE||t[t.length-4].position.y===21*F.BLOCK_SIZE)},g=t=>{let n=t.length;if(n<4)return!1;for(let e=0;e<4;e++)if(1==i.map[(t[n-(e+1)].position.y-r)/F.BLOCK_SIZE+3][(t[n-(e+1)].position.x-l.value)/F.BLOCK_SIZE])return!0;return!1};Q((async t=>{if(console.log("KEY:",t.key),e.value=t.key,"ArrowLeft"===e.value&&(O(),w(),S(),T()),"ArrowRight"===e.value&&(_(),w(),y(),T()),"ArrowDown"===e.value&&(v(i.minoList)||g(i.minoList)||(f(i.minoList),i.t=1,i.totalScore+=5,n.emit("score",i.totalScore))),"ArrowUp"===e.value){while(!v(i.minoList)&&!g(i.minoList))f(i.minoList),i.totalScore+=5;n.emit("score",i.totalScore),s=!0}"x"===e.value&&(await k(),T()),"z"===e.value&&(await K(),T()),"a"===e.value&&a&&(h(),a=!1,s=!0)}));const w=async()=>{let t=0,n=i.minoList.length;return(i.minoList[n-1].position.x>l.value+9*F.BLOCK_SIZE||i.minoList[n-2].position.x>l.value+9*F.BLOCK_SIZE||i.minoList[n-3].position.x>l.value+9*F.BLOCK_SIZE||i.minoList[n-4].position.x>l.value+9*F.BLOCK_SIZE)&&(O(),t++,w()),(i.minoList[n-1].position.x<l.value||i.minoList[n-2].position.x<l.value||i.minoList[n-3].position.x<l.value||i.minoList[n-4].position.x<l.value)&&(_(),t++,w()),t},S=async()=>{let t=0;const n=[i.minoList[i.minoList.length-4].position,i.minoList[i.minoList.length-3].position,i.minoList[i.minoList.length-2].position,i.minoList[i.minoList.length-1].position];return 1!=i.map[(n[0].y-r)/F.BLOCK_SIZE+2][(n[0].x-l.value)/F.BLOCK_SIZE]&&1!=i.map[(n[1].y-r)/F.BLOCK_SIZE+2][(n[1].x-l.value)/F.BLOCK_SIZE]&&1!=i.map[(n[2].y-r)/F.BLOCK_SIZE+2][(n[2].x-l.value)/F.BLOCK_SIZE]&&1!=i.map[(n[3].y-r)/F.BLOCK_SIZE+2][(n[3].x-l.value)/F.BLOCK_SIZE]||(_(),t++,t+=await S()),t},y=async()=>{let t=0;const n=[i.minoList[i.minoList.length-4].position,i.minoList[i.minoList.length-3].position,i.minoList[i.minoList.length-2].position,i.minoList[i.minoList.length-1].position];return 1!==i.map[(n[0].y-r)/F.BLOCK_SIZE+2][(n[0].x-l.value)/F.BLOCK_SIZE]&&1!==i.map[(n[1].y-r)/F.BLOCK_SIZE+2][(n[1].x-l.value)/F.BLOCK_SIZE]&&1!==i.map[(n[2].y-r)/F.BLOCK_SIZE+2][(n[2].x-l.value)/F.BLOCK_SIZE]&&1!==i.map[(n[3].y-r)/F.BLOCK_SIZE+2][(n[3].x-l.value)/F.BLOCK_SIZE]||(O(),t++,t+=await y()),t},O=()=>{let t=i.minoList.length;for(let n=0;n<4;n++)i.minoList[t-(n+1)].slideLeft()},_=()=>{let t=i.minoList.length;for(let n=0;n<4;n++)i.minoList[t-(n+1)].slideRight()},f=t=>{let n=t.length;if(0!=n)for(let e=0;e<4;e++)t[n-(e+1)].drop()},Z=()=>{let t=i.minoList.length;if("O"!=i.minoList[t-4].name)for(let n=0;n<4;n++)i.minoList[t-(4-n)].position=new j(i.minoList[t-4].position.x-i.minoList[t-(4-n)].shape[n].y*F.BLOCK_SIZE,i.minoList[t-4].position.y+i.minoList[t-(4-n)].shape[n].x*F.BLOCK_SIZE),i.minoList[t-(4-n)].shape[n]=new j(-1*i.minoList[t-(4-n)].shape[n].y,i.minoList[t-(4-n)].shape[n].x)},E=()=>{let t=i.minoList.length;if("O"!=i.minoList[t-4].name)for(let n=1;n<4;n++)i.minoList[t-(4-n)].position=new j(i.minoList[t-4].position.x+i.minoList[t-(4-n)].shape[n].y*F.BLOCK_SIZE,i.minoList[t-4].position.y-i.minoList[t-(4-n)].shape[n].x*F.BLOCK_SIZE),i.minoList[t-(4-n)].shape[n]=new j(i.minoList[t-(4-n)].shape[n].y,-1*i.minoList[t-(4-n)].shape[n].x)},C=(t,n)=>{let e=i.minoList.length;for(let o=0;o<4;o++)i.minoList[e-(4-o)].position=t[o],i.minoList[e-(4-o)].shape[o]=n[o]},B=t=>"I"===t,I=(t,n,e,o)=>{let s=i.minoList.length;return((B(i.minoList[s-4].name)?n>2:n>1)||i.minoList[s-1].position.x<l.value||i.minoList[s-2].position.x<l.value||i.minoList[s-3].position.x<l.value||i.minoList[s-4].position.x<l.value||i.minoList[s-1].position.x>l.value+9*F.BLOCK_SIZE||i.minoList[s-2].position.x>l.value+9*F.BLOCK_SIZE||i.minoList[s-3].position.x>l.value+9*F.BLOCK_SIZE||i.minoList[s-4].position.x>l.value+9*F.BLOCK_SIZE)&&(C(e,o),!0)},k=async()=>{const t=i.minoList.length;let n=[i.minoList[t-4].position,i.minoList[t-3].position,i.minoList[t-2].position,i.minoList[t-1].position],e=[i.minoList[t-4].shape[0],i.minoList[t-3].shape[1],i.minoList[t-2].shape[2],i.minoList[t-1].shape[3]];if(Z(),v(i.minoList))return void C(n,e);const o=await w();let s=await S();I(o,s,n,e)&&Z();const a=await y();I(o,a,n,e)},K=async()=>{const t=i.minoList.length;let n=[i.minoList[t-4].position,i.minoList[t-3].position,i.minoList[t-2].position,i.minoList[t-1].position],e=[i.minoList[t-4].shape[0],i.minoList[t-3].shape[1],i.minoList[t-2].shape[2],i.minoList[t-1].shape[3]];if(E(),v(i.minoList))return void C(n,e);const o=await w();let s=await y();I(o,s,n,e)&&E();const a=await S();I(o,a,n,e)},x=()=>{let t=0,n=!1;for(let e=2;e<i.map.length;e++){let o=0;for(let t=0;t<i.map[e].length;t++)o+=i.map[e][t];if(10===o){i.deleteLineNum++,t++,n=!0;for(let t=i.minoList.length-1;t>=0;t--){let n=i.minoList[t].position.y,o=r+(e-2)*F.BLOCK_SIZE;n===o?i.minoList.splice(t,1):n<o&&i.minoList[t].drop()}c(),i.deleteLineNum%5===0&&Math.ceil(i.deleteLineNum/5)<30&&(i.level=Math.ceil(i.deleteLineNum/5)+1)}}n?i.ren++:i.ren=0,i.totalScore+=t*t*100,i.totalScore+=t*t*i.ren*20,t=0},T=()=>{const t=i.minoList.length;i.ghost=JSON.parse(JSON.stringify([]));for(let n=0;n<4;n++){let e=i.minoList[t-(n+1)].position.x,o=i.minoList[t-(n+1)].position.y;const s=i.minoList[t-(n+1)].name,a=JSON.parse(JSON.stringify(i.minoList[t-(n+1)].shape)),l=F.COLORS[s],r="0.3";i.ghost.push(new $(e,o,s,l,a,r))}while(!v(i.ghost)&&!g(i.ghost))f(i.ghost)};for(let o=0;o<4;o++)m();L(),d(),T(),P((()=>1!==i.map[1][4]&&((i.t%(46-Math.floor(1.5*i.level))===0||s)&&(v(i.minoList)||g(i.minoList)?(c(),x(),console.log("REN",i.ren),console.log("SCORE",i.totalScore),b(),L(),d(),T(),a=!0,n.emit("score",i.totalScore)):(f(i.minoList),T()),s&&(s=!1,i.t=0)),i.t++,i.healthCheckTime++,!0)));const b=()=>{n.emit("map",i.map),n.emit("level",i.level)},N=()=>{const t=Math.floor(.5*window.innerWidth)-5*F.BLOCK_SIZE;for(let n=0;n<i.minoList.length;n++)i.minoList[n].resize(t-l.value);for(let n=0;n<i.holdMino.length;n++)i.holdMino[n].resize(t-l.value);for(let n=0;n<i.ghost.length;n++)i.ghost[n].resize(t-l.value);for(let n=0;n<i.stock.length;n++)i.stock[n].resize(t-l.value);l.value=t};return(0,o.bv)((()=>{window.addEventListener("resize",N)})),{baseX:l,drawMino:m,hold:h,stageState:i,mapEmit:b}}});const nt=(0,r.Z)(tt,[["render",V],["__scopeId","data-v-69071696"]]);var et=nt,it=(0,o.aZ)({name:"PlayBoardLayer",components:{Block:A,MinoLayer:et},props:{},setup(t,n){const e=(0,M.qj)({map:[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],wallList:[],t:0}),i=t=>{e.map=t};let s=(0,M.iH)(Math.floor(.5*window.innerWidth)-6*F.BLOCK_SIZE),a=(0,M.iH)(Math.floor(.5*window.innerWidth)+5*F.BLOCK_SIZE);const l=()=>{let t=2*F.BLOCK_SIZE,n=22*F.BLOCK_SIZE,i=0;for(let o=0;o<21;o++)e.wallList.push(new $(s.value,t+o*F.BLOCK_SIZE,"wall","128,128,128",[])),e.wallList.push(new $(a.value,t+o*F.BLOCK_SIZE,"wall","128,128,128",[])),i<10&&(e.wallList.push(new $(s.value+(i+1)*F.BLOCK_SIZE,n,"wall","128, 128, 128",[])),i++)};let r=(0,M.iH)(0);const c=t=>{r.value=t};let p=(0,M.iH)(1);const u=t=>{p.value=t};l(),console.log("Game Start"),P((()=>1!==e.map[1][4]||(console.log("Game Over"),n.emit("ending",!0),n.emit("score",r.value),!1)));const m=()=>{const t=Math.floor(.5*window.innerWidth)-6*F.BLOCK_SIZE;for(let n=0;n<e.wallList.length;n++)e.wallList[n].resize(t-s.value);s.value=t};return(0,o.bv)((()=>{window.addEventListener("resize",m)})),{baseX1:s,baseX2:a,stageState:e,getMap:i,totalScore:r,updateScore:c,level:p,setLevel:u}}});const ot=(0,r.Z)(it,[["render",z],["__scopeId","data-v-3abde733"]]);var st=ot,at=e(6265),lt=e.n(at);class rt{async sendScore(t,n){const e={name:t,score:n},i=await lt().post("https://tetris-vue-db.herokuapp.com/score/register",e);return i.data}async getRanking(){const t=await lt().get("https://tetris-vue-db.herokuapp.com/score/ranking").catch((t=>t.response));return t.data}async healthCheck(){return await lt().get("https://tetris-vue-db.herokuapp.com/score/").catch((t=>t.response)),!0}}var ct=(0,o.aZ)({name:"Stage",components:{PlayBoardLayer:st},props:{maxFish:{type:Number,default:50}},setup(){let t=(0,M.iH)(!1),n=(0,M.iH)(0),e=(0,M.iH)("");const i=(0,u.tv)(),o=new rt,s=n=>{n&&(t.value=!0)},a=t=>{n.value=t},l=async(t,n)=>await o.sendScore(t,n),r=async()=>(await l(e.value,n.value),i.replace({name:"Ranking"})),c=()=>(console.log("click!!!"),i.replace({name:"Top"}));return{flag:t,score:n,userName:e,ending:s,resultScore:a,moveToRanking:r,moveToTop:c}}});const pt=(0,r.Z)(ct,[["render",b],["__scopeId","data-v-90124848"]]);var ut=pt;const mt=t=>((0,o.dD)("data-v-5a3317a2"),t=t(),(0,o.Cn)(),t),ht=mt((()=>(0,o._)("h1",null,"Score Ranking TOP 10",-1))),Lt={id:"ranking"};function dt(t,n,e,i,s,a){return(0,o.wg)(),(0,o.iD)(o.HY,null,[ht,(0,o._)("div",Lt,[(0,o._)("table",null,[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.headers,((t,n)=>((0,o.wg)(),(0,o.iD)("th",{key:n},(0,m.zw)(t),1)))),128))])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.ranking,((t,n)=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("th",null,(0,m.zw)(n+1),1),(0,o._)("td",null,(0,m.zw)(t.name),1),(0,o._)("td",null,(0,m.zw)(t.score),1)])))),128))])]),(0,o._)("button",{id:"return",onClick:n[0]||(n[0]=(...n)=>t.moveToTop&&t.moveToTop(...n))},"Topへ戻る")])],64)}var vt=(0,o.aZ)({name:"Ranking",setup(){const t=(0,u.tv)(),n=new rt;let e=(0,M.iH)([]);const i=["No.","名前","スコア"],o=async()=>{e.value=await n.getRanking()},s=()=>t.replace({name:"Top"});return o(),{ranking:e,headers:i,moveToTop:s}}});const gt=(0,r.Z)(vt,[["render",dt],["__scopeId","data-v-5a3317a2"]]);var wt=gt;const St=[{path:"/",name:"Top",component:E},{path:"/tetris",name:"Tetris",component:ut},{path:"/ranking",name:"Ranking",component:wt}],yt=(0,u.p7)({history:(0,u.PO)(""),routes:St});var Ot=yt;(0,i.ri)(p).use(Ot).mount("#app")}},n={};function e(i){var o=n[i];if(void 0!==o)return o.exports;var s=n[i]={exports:{}};return t[i](s,s.exports,e),s.exports}e.m=t,function(){var t=[];e.O=function(n,i,o,s){if(!i){var a=1/0;for(p=0;p<t.length;p++){i=t[p][0],o=t[p][1],s=t[p][2];for(var l=!0,r=0;r<i.length;r++)(!1&s||a>=s)&&Object.keys(e.O).every((function(t){return e.O[t](i[r])}))?i.splice(r--,1):(l=!1,s<a&&(a=s));if(l){t.splice(p--,1);var c=o();void 0!==c&&(n=c)}}return n}s=s||0;for(var p=t.length;p>0&&t[p-1][2]>s;p--)t[p]=t[p-1];t[p]=[i,o,s]}}(),function(){e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,{a:n}),n}}(),function(){e.d=function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)}}(),function(){var t={143:0};e.O.j=function(n){return 0===t[n]};var n=function(n,i){var o,s,a=i[0],l=i[1],r=i[2],c=0;if(a.some((function(n){return 0!==t[n]}))){for(o in l)e.o(l,o)&&(e.m[o]=l[o]);if(r)var p=r(e)}for(n&&n(i);c<a.length;c++)s=a[c],e.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return e.O(p)},i=self["webpackChunkvue3_tetris"]=self["webpackChunkvue3_tetris"]||[];i.forEach(n.bind(null,0)),i.push=n.bind(null,i.push.bind(i))}();var i=e.O(void 0,[998],(function(){return e(1465)}));i=e.O(i)})();
//# sourceMappingURL=app.73f3dbe7.js.map