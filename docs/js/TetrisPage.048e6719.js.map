{"version":3,"file":"js/TetrisPage.048e6719.js","mappings":"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","sources":["webpack://vue3-tetris/./src/views/Stage.vue?49ea","webpack://vue3-tetris/./src/components/PlayBoardLayer.vue?b861","webpack://vue3-tetris/./src/components/Block.ts","webpack://vue3-tetris/./src/core/useAnimationFrame.ts","webpack://vue3-tetris/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://vue3-tetris/./src/core/Point.ts","webpack://vue3-tetris/./src/core/Constants.ts","webpack://vue3-tetris/./src/core/MinoModel.ts","webpack://vue3-tetris/./src/components/Mino.vue?902e","webpack://vue3-tetris/./src/core/useKeyEvent.ts","webpack://vue3-tetris/./src/components/Mino.vue?be3a","webpack://vue3-tetris/./src/components/Mino.vue","webpack://vue3-tetris/./src/components/PlayBoardLayer.vue?0ef2","webpack://vue3-tetris/./src/components/PlayBoardLayer.vue","webpack://vue3-tetris/./src/views/Stage.vue?f327","webpack://vue3-tetris/./src/views/Stage.vue"],"sourcesContent":["import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, createTextVNode as _createTextVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createStaticVNode as _createStaticVNode, Fragment as _Fragment, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-401db482\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/_createStaticVNode(\"<div class=\\\"arrow\\\" data-v-401db482><div id=\\\"first\\\" data-v-401db482>↑</div><div id=\\\"second\\\" data-v-401db482>↑</div><div id=\\\"third\\\" data-v-401db482>↑</div></div><div class=\\\"holdFrame\\\" data-v-401db482></div><div class=\\\"title\\\" id=\\\"hold\\\" data-v-401db482>HOLD</div><div class=\\\"stockFrame\\\" data-v-401db482></div><div class=\\\"title\\\" id=\\\"stock\\\" data-v-401db482>NEXT</div>\", 5)\nconst _hoisted_6 = {\n  key: 0,\n  class: \"end\"\n}\nconst _hoisted_7 = { class: \"message\" }\nconst _hoisted_8 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"header\" }, [\n  /*#__PURE__*/_createElementVNode(\"span\", null, \" Result \")\n], -1))\nconst _hoisted_9 = { class: \"body\" }\nconst _hoisted_10 = { class: \"footer\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_PlayBoardLayer = _resolveComponent(\"PlayBoardLayer\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_component_PlayBoardLayer, {\n      onEnding: _ctx.ending,\n      onScore: _ctx.resultScore\n    }, null, 8, [\"onEnding\", \"onScore\"]),\n    _hoisted_1,\n    (_ctx.flag)\n      ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [\n          _createElementVNode(\"div\", _hoisted_7, [\n            _hoisted_8,\n            _createElementVNode(\"div\", _hoisted_9, [\n              _createElementVNode(\"span\", null, \"スコア：\" + _toDisplayString(_ctx.score), 1),\n              _createElementVNode(\"span\", null, [\n                _createTextVNode(\"ユーザー名： \"),\n                _withDirectives(_createElementVNode(\"input\", {\n                  \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_ctx.userName) = $event))\n                }, null, 512), [\n                  [_vModelText, _ctx.userName]\n                ])\n              ])\n            ]),\n            _createElementVNode(\"div\", _hoisted_10, [\n              _createElementVNode(\"button\", {\n                onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.moveToTop && _ctx.moveToTop(...args)))\n              }, \"Topへ戻る\"),\n              _createElementVNode(\"button\", {\n                id: \"sendButton\",\n                onClick: _cache[2] || (_cache[2] = \n//@ts-ignore\n(...args) => (_ctx.moveToRanking && _ctx.moveToRanking(...args)))\n              }, \"ランキングへ送信\")\n            ])\n          ])\n        ]))\n      : (_openBlock(), _createElementBlock(\"button\", {\n          key: 1,\n          id: \"return\",\n          onClick: _cache[3] || (_cache[3] = \n//@ts-ignore\n(...args) => (_ctx.moveToTop && _ctx.moveToTop(...args)))\n        }, \"Topへ戻る\"))\n  ], 64))\n}","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-3abde733\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"PlayBoardLayerRoot\" }\nconst _hoisted_2 = { class: \"level\" }\nconst _hoisted_3 = { class: \"score\" }\nconst _hoisted_4 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"br\", null, null, -1))\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Block = _resolveComponent(\"Block\")!\n  const _component_MinoLayer = _resolveComponent(\"MinoLayer\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.stageState.wallList, (blockProps) => {\n        return (_openBlock(), _createBlock(_component_Block, {\n          key: blockProps.id,\n          class: \"BlockElement\",\n          x: blockProps.position.x,\n          y: blockProps.position.y,\n          angle: blockProps.angle,\n          color: blockProps.color\n        }, null, 8, [\"x\", \"y\", \"angle\", \"color\"]))\n      }), 128)),\n      _createVNode(_component_MinoLayer, {\n        onMap: _ctx.getMap,\n        onScore: _ctx.updateScore,\n        onLevel: _ctx.setLevel\n      }, null, 8, [\"onMap\", \"onScore\", \"onLevel\"])\n    ]),\n    _createElementVNode(\"div\", _hoisted_2, \"Lv.\" + _toDisplayString(_ctx.level), 1),\n    _createElementVNode(\"div\", _hoisted_3, [\n      _createTextVNode(\"SCORE\"),\n      _hoisted_4,\n      _createTextVNode(_toDisplayString(_ctx.totalScore), 1)\n    ])\n  ], 64))\n}","// ブロックのDOMを表示するためのコンポーネントです。\n// Vueとして状態を管理する必要がないので関数コンポーネントにしています。\n\nimport { h } from \"vue\";\nimport { Point } from \"../core/Point\";\n\ntype Props = {\n  x: number;\n  y: number;\n  angle: number;\n  color: string;\n  shape: Point[];\n  scale: number;\n};\n\nexport const Block = (props: Props) => {\n  const style = `color: ${props.color};transform: translate(${props.x}px, ${props.y}px);`;\n  return h(\"div\", { class: \"BlockRoot\", style });\n};\n","import { onMounted, onBeforeUnmount } from \"vue\";\n\n/**\n * requestAnimatinFrameの処理を登録します。\n * @param onFire 処理。次のフレームでも継続して呼び出す場合、trueを返してください。\n */\nexport const useAnimationFrame = (onFire: () => boolean) => {\n  let isTerminated = false;\n\n  onMounted(() => {\n    const tick = () => {\n      requestAnimationFrame(() => {\n        if (isTerminated) {\n          return;\n        }\n        const shouldContinue = onFire();\n        if (shouldContinue) {\n          tick();\n        }\n      });\n    };\n    tick();\n  });\n  onBeforeUnmount(() => {\n    isTerminated = true;\n  });\n\n  return {};\n};\n","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export class Point {\n  readonly x: number;\n  readonly y: number;\n  constructor(x = 0, y = 0) {\n    this.x = x;\n    this.y = y;\n  }\n\n  get length(): number {\n    return Math.sqrt(this.x ** 2 + this.y ** 2);\n  }\n\n  get angle(): number {\n    const rad2angle = (r: number): number => (r / Math.PI) * 180;\n    return rad2angle(Math.atan2(this.y, this.x));\n  }\n\n  add(p: Point): Point {\n    return new Point(this.x + p.x, this.y + p.y);\n  }\n\n  sub(p: Point): Point {\n    return new Point(this.x - p.x, this.y - p.y);\n  }\n\n  times(n: number): Point {\n    return new Point(this.x * n, this.y * n);\n  }\n\n  unit(unitLength = 1): Point {\n    const len = this.length;\n    return new Point((this.x / len) * unitLength, (this.y / len) * unitLength);\n  }\n\n  limit(maxLength = 1): Point {\n    return this.length <= maxLength ? this : this.unit(maxLength);\n  }\n\n  rotate(deg: number): Point {\n    const angle2rad = (a: number): number => (a * Math.PI) / 180;\n    const rad = angle2rad(this.angle + deg);\n    const l = this.length;\n    return new Point(Math.cos(rad) * l, Math.sin(rad) * l);\n  }\n}\n","import { Point } from \"./Point\";\n\nexport class Constants {\n  static readonly BLOCK_SIZE = 40;\n  static readonly NAMES: string[] = [\"T\", \"I\", \"O\", \"L\", \"J\", \"S\", \"Z\"];\n  static readonly COLORS: { [index: string]: string } = {\n    T: \"138, 43, 226\", //\"blueviolet\", //#8A2BE2\n    I: \"0, 255, 255\", //\"cyan\", #00FFFF\n    L: \"0, 0, 255\", //\"blue\",\t#0000FF\n    J: \"255, 165, 0\", //\"orange\", #FFA500\n    O: \"255, 255, 0\", //\"yellow\", #FFFF00\n    S: \"0, 255, 0\", //\"lime\", #00FF00\n    Z: \"255, 0, 0\", //\"red\", #FF0000\n  };\n  static readonly SHAPE: { [index: string]: Point[] } = {\n    T: [new Point(0, 0), new Point(0, -1), new Point(-1, 0), new Point(1, 0)],\n    I: [new Point(0, 0), new Point(-1, 0), new Point(1, 0), new Point(2, 0)],\n    L: [new Point(0, 0), new Point(-1, 0), new Point(1, 0), new Point(1, -1)],\n    J: [new Point(0, 0), new Point(-1, -1), new Point(-1, 0), new Point(1, 0)],\n    O: [new Point(0, 0), new Point(1, 0), new Point(0, -1), new Point(1, -1)],\n    S: [new Point(0, 0), new Point(-1, 0), new Point(0, -1), new Point(1, -1)],\n    Z: [new Point(0, 0), new Point(-1, -1), new Point(0, -1), new Point(1, 0)],\n  };\n}\nexport default Constants;\n","import { Point } from \"./Point\";\nimport Constants from \"./Constants\";\n\nconst DEFAULT_FORCE = 0.25;\nlet instanseCount = 0;\n\nconst randomName = () => {\n  return Constants.NAMES[Math.floor(Math.random() * 7)];\n};\n\nexport class MinoModel {\n  readonly id = instanseCount++;\n  position = new Point(0, 0);\n  name = randomName();\n  angle = Math.random() * 360;\n  vector = new Point();\n  force = DEFAULT_FORCE;\n  color = \"\";\n  shape: Point[] = [];\n  insensitiveTerms = 0;\n  constructor(\n    x: number,\n    y: number,\n    name: string,\n    color: string,\n    shape: Point[],\n    opacity?: string\n  ) {\n    this.position = new Point(x, y);\n    this.name = name;\n    if (!opacity) this.color = \"rgba(\" + color + \", 1.0)\";\n    else this.color = \"rgba(\" + color + \", \" + opacity + \")\";\n    this.shape = shape;\n  }\n\n  update() {\n    const vec = new Point(0, Constants.BLOCK_SIZE);\n    this.position = this.position.add(vec);\n    if (this.position.y > Constants.BLOCK_SIZE * 20) {\n      this.position = new Point(this.position.x, Constants.BLOCK_SIZE * 20);\n    }\n    if (this.position.y < 0) {\n      this.position = new Point(this.position.x, 0);\n    }\n  }\n  drop() {\n    const vec = new Point(0, Constants.BLOCK_SIZE);\n    this.position = this.position.add(vec);\n    if (this.position.y > Constants.BLOCK_SIZE * 21) {\n      this.position = new Point(this.position.x, Constants.BLOCK_SIZE * 21);\n    }\n  }\n\n  slideLeft() {\n    this.position = new Point(\n      this.position.x - Constants.BLOCK_SIZE,\n      this.position.y\n    );\n  }\n\n  slideRight() {\n    this.position = new Point(\n      this.position.x + Constants.BLOCK_SIZE,\n      this.position.y\n    );\n  }\n\n  slideUp() {\n    this.position = new Point(\n      this.position.x,\n      this.position.y - Constants.BLOCK_SIZE\n    );\n  }\n\n  setForce(value: number) {\n    this.force = value;\n  }\n\n  resize(difference: number) {\n    this.position = new Point(this.position.x + difference, this.position.y);\n  }\n}\n","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-1f1d4de8\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"MinoLayerRoot\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_Block = _resolveComponent(\"Block\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.stageState.ghost, (block) => {\n      return (_openBlock(), _createBlock(_component_Block, {\n        key: block.id,\n        class: \"BlockElement\",\n        x: block.position.x,\n        y: block.position.y,\n        angle: block.angle,\n        color: block.color,\n        scale: block.scale\n      }, null, 8, [\"x\", \"y\", \"angle\", \"color\", \"scale\"]))\n    }), 128)),\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.stageState.minoList, (blockProps) => {\n      return (_openBlock(), _createBlock(_component_Block, {\n        key: blockProps.id,\n        class: \"BlockElement\",\n        x: blockProps.position.x,\n        y: blockProps.position.y,\n        angle: blockProps.angle,\n        color: blockProps.color,\n        scale: blockProps.scale\n      }, null, 8, [\"x\", \"y\", \"angle\", \"color\", \"scale\"]))\n    }), 128)),\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.stageState.holdMino, (block) => {\n      return (_openBlock(), _createBlock(_component_Block, {\n        key: block.id,\n        class: \"BlockElement\",\n        x: block.position.x,\n        y: block.position.y,\n        angle: block.angle,\n        color: block.color,\n        scale: block.scale\n      }, null, 8, [\"x\", \"y\", \"angle\", \"color\", \"scale\"]))\n    }), 128)),\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.stageState.stock, (block) => {\n      return (_openBlock(), _createBlock(_component_Block, {\n        key: block.id,\n        class: \"BlockElement\",\n        x: block.position.x,\n        y: block.position.y,\n        angle: block.angle,\n        color: block.color,\n        scale: block.scale\n      }, null, 8, [\"x\", \"y\", \"angle\", \"color\", \"scale\"]))\n    }), 128))\n  ]))\n}","import { onMounted, onUnmounted } from \"vue\";\n\ntype KeyEventHandler = (ev: KeyboardEvent) => void;\n\nexport const useKeyDown = (\n  handler: KeyEventHandler,\n  targetDom?: HTMLElement\n) => {\n  const onKeyDown = (ev: KeyboardEvent): void => {\n    handler?.(ev);\n  };\n\n  onMounted(() => {\n    const target = targetDom ?? document.body;\n    target.addEventListener(\"keydown\", onKeyDown);\n  });\n  onUnmounted(() => {\n    const target = targetDom ?? document.body;\n    target.removeEventListener(\"keydown\", onKeyDown);\n  });\n\n  return {};\n};\n","\nimport { defineComponent, onMounted, reactive, ref } from \"vue\";\nimport { Block } from \"./Block\";\nimport { Point } from \"../core/Point\";\nimport { useAnimationFrame } from \"../core/useAnimationFrame\";\nimport { MinoModel } from \"../core/MinoModel\";\nimport Constants from \"../core/Constants\";\nimport { useKeyDown } from \"../core/useKeyEvent\";\n\n/**\n * ミノレイヤーの状態を管理する型\n */\ntype StageState = {\n  minoList: MinoModel[];\n  map: number[][];\n  t: number;\n  healthCheckTime: number;\n  name: string[];\n  holdMino: MinoModel[];\n  stock: MinoModel[];\n  ghost: MinoModel[];\n  totalScore: number;\n  ren: number;\n  deleteLineNum: number;\n  level: number;\n};\n\nexport default defineComponent({\n  name: \"MinoLayer\",\n  components: { Block },\n  props: {\n    keyInput: { type: String, default: \"\" },\n  },\n  setup(props, ctx) {\n    // state: レイヤーの状態\n    // const { keyInput } = toRefs(props);\n    let keyInput = ref(\"\");\n    const stageState = reactive<StageState>({\n      minoList: [],\n      map: [\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n      ],\n      t: 0,\n      healthCheckTime: 0,\n      name: JSON.parse(JSON.stringify(Constants.NAMES)),\n      holdMino: [],\n      stock: [],\n      ghost: [],\n      totalScore: 0,\n      ren: 0,\n      deleteLineNum: 0,\n      level: 1,\n    });\n    let forceRefresh = false;\n    let canHold = true;\n    let baseX = ref(\n      Math.floor(0.5 * window.innerWidth) - 5 * Constants.BLOCK_SIZE\n    );\n    let baseY = 2 * Constants.BLOCK_SIZE;\n    const record = () => {\n      stageState.map = JSON.parse(\n        JSON.stringify(new Array(22).fill(new Array(10).fill(0)))\n      );\n      stageState.minoList.map((mino) => {\n        stageState.map[(mino.position.y - baseY) / Constants.BLOCK_SIZE + 2][\n          (mino.position.x - baseX.value) / Constants.BLOCK_SIZE\n        ] = 1;\n      });\n    };\n    const refill_mino_name = () => {\n      stageState.name.push(\"T\");\n      stageState.name.push(\"I\");\n      stageState.name.push(\"O\");\n      stageState.name.push(\"L\");\n      stageState.name.push(\"J\");\n      stageState.name.push(\"S\");\n      stageState.name.push(\"Z\");\n    };\n    const minoNamePopper = () => {\n      let t: number = Math.floor(Math.random() * stageState.name.length);\n      if (stageState.name.length === 0) {\n        refill_mino_name();\n      }\n      const res = stageState.name[t];\n      stageState.name.splice(t, 1);\n      return res;\n    };\n    const drawMino = () => {\n      let x = baseX.value + 14 * Constants.BLOCK_SIZE;\n      let y = 20 * Constants.BLOCK_SIZE;\n      const name = minoNamePopper();\n      const color = Constants.COLORS[name];\n      const shape = JSON.parse(JSON.stringify(Constants.SHAPE[name]));\n      for (let i = 0; i < shape.length; i++) {\n        stageState.stock.push(\n          new MinoModel(\n            x + shape[i].x * Constants.BLOCK_SIZE,\n            y + shape[i].y * Constants.BLOCK_SIZE,\n            name,\n            color,\n            shape\n          )\n        );\n      }\n    };\n    const hold = () => {\n      const x = baseX.value - 5 * Constants.BLOCK_SIZE;\n      const y = baseY + 3 * Constants.BLOCK_SIZE;\n      for (let i = 0; i < 4; i++) {\n        let length = stageState.minoList.length;\n        const temp = stageState.minoList[length - 1];\n        const name = JSON.parse(JSON.stringify(temp.name));\n        const color = Constants.COLORS[name];\n        const shape = JSON.parse(JSON.stringify(Constants.SHAPE[name]));\n        stageState.holdMino.push(\n          new MinoModel(\n            x + shape[i].x * Constants.BLOCK_SIZE,\n            y + shape[i].y * Constants.BLOCK_SIZE,\n            name,\n            color,\n            shape\n          )\n        );\n        stageState.minoList.splice(length - 1, 1);\n      }\n      if (stageState.holdMino.length !== 4) {\n        const temp = stageState.holdMino[0];\n        let x = baseX.value + 4 * Constants.BLOCK_SIZE;\n        let y = 1 * Constants.BLOCK_SIZE;\n        const name = JSON.parse(JSON.stringify(temp.name));\n        const color = Constants.COLORS[name];\n        const shape = JSON.parse(JSON.stringify(Constants.SHAPE[name]));\n        for (let i = 0; i < 4; i++) {\n          stageState.minoList.push(\n            new MinoModel(\n              x + shape[i].x * Constants.BLOCK_SIZE,\n              y + shape[i].y * Constants.BLOCK_SIZE,\n              name,\n              color,\n              shape\n            )\n          );\n          stageState.holdMino.shift();\n        }\n      } else {\n        shiftStock();\n        alignStock();\n      }\n    };\n\n    const shiftStock = () => {\n      let x = baseX.value + 4 * Constants.BLOCK_SIZE;\n      let y = 1 * Constants.BLOCK_SIZE;\n      let name = stageState.stock[0].name;\n      const shape = JSON.parse(JSON.stringify(Constants.SHAPE[name]));\n      const color = Constants.COLORS[name];\n      drawMino();\n      for (let i = 0; i < shape.length; i++) {\n        stageState.minoList.push(\n          new MinoModel(\n            x + shape[i].x * Constants.BLOCK_SIZE,\n            y + shape[i].y * Constants.BLOCK_SIZE,\n            name,\n            color,\n            shape\n          )\n        );\n        stageState.stock.shift();\n      }\n    };\n\n    const alignStock = () => {\n      stageState.stock.map((mino, index) => {\n        mino.position = new Point(\n          mino.position.x,\n          (4 +\n            Constants.SHAPE[mino.name][index % 4].y +\n            Math.floor(index / 4) * 3) *\n            Constants.BLOCK_SIZE\n        );\n      });\n    };\n\n    const isBottom = (minoList: MinoModel[]) => {\n      let length = minoList.length;\n      if (length < 4) return false;\n      if (\n        minoList[minoList.length - 1].position.y ===\n          Constants.BLOCK_SIZE * 21 ||\n        minoList[minoList.length - 2].position.y ===\n          Constants.BLOCK_SIZE * 21 ||\n        minoList[minoList.length - 3].position.y ===\n          Constants.BLOCK_SIZE * 21 ||\n        minoList[minoList.length - 4].position.y === Constants.BLOCK_SIZE * 21\n      )\n        return true;\n      return false;\n    };\n\n    const isCollision = (minoList: MinoModel[]) => {\n      let length = minoList.length;\n      if (length < 4) return false;\n      for (let i = 0; i < 4; i++) {\n        if (\n          stageState.map[\n            (minoList[length - (i + 1)].position.y - baseY) /\n              Constants.BLOCK_SIZE +\n              3\n          ][\n            (minoList[length - (i + 1)].position.x - baseX.value) /\n              Constants.BLOCK_SIZE\n          ] == 1\n        )\n          return true;\n      }\n      return false;\n    };\n    useKeyDown(async (event: KeyboardEvent) => {\n      // console.log(\"KEY:\", event.key);\n      keyInput.value = event.key;\n      if (keyInput.value === \"ArrowLeft\") {\n        slideLeft();\n        collisionToWall();\n        collisionToLeftMino();\n        setGhost();\n      }\n      if (keyInput.value === \"ArrowRight\") {\n        slideRight();\n        collisionToWall();\n        collisionToRightMino();\n        setGhost();\n      }\n      if (keyInput.value === \"ArrowDown\") {\n        if (\n          !isBottom(stageState.minoList) &&\n          !isCollision(stageState.minoList)\n        ) {\n          drop(stageState.minoList);\n          stageState.t = 1;\n          stageState.totalScore += 5;\n          ctx.emit(\"score\", stageState.totalScore);\n        }\n      }\n      if (keyInput.value === \"ArrowUp\") {\n        while (\n          !isBottom(stageState.minoList) &&\n          !isCollision(stageState.minoList)\n        ) {\n          drop(stageState.minoList);\n          stageState.totalScore += 5;\n        }\n        ctx.emit(\"score\", stageState.totalScore);\n        forceRefresh = true;\n      }\n      if (keyInput.value === \"x\") {\n        await superRotateRight();\n        setGhost();\n      }\n      if (keyInput.value === \"z\") {\n        await superRotateLeft();\n        setGhost();\n      }\n      if (keyInput.value === \"a\") {\n        if (canHold) {\n          hold();\n          canHold = false;\n          forceRefresh = true;\n        }\n      }\n    });\n\n    const collisionToWall = async () => {\n      let counter = 0;\n      let length = stageState.minoList.length;\n      if (\n        stageState.minoList[length - 1].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9 ||\n        stageState.minoList[length - 2].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9 ||\n        stageState.minoList[length - 3].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9 ||\n        stageState.minoList[length - 4].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9\n      ) {\n        slideLeft();\n        counter++;\n        collisionToWall();\n      }\n      if (\n        stageState.minoList[length - 1].position.x < baseX.value ||\n        stageState.minoList[length - 2].position.x < baseX.value ||\n        stageState.minoList[length - 3].position.x < baseX.value ||\n        stageState.minoList[length - 4].position.x < baseX.value\n      ) {\n        slideRight();\n        counter++;\n        collisionToWall();\n      }\n      return counter;\n    };\n\n    const collisionToLeftMino = async () => {\n      let counter = 0;\n      const currentPos: Point[] = [\n        stageState.minoList[stageState.minoList.length - 4].position,\n        stageState.minoList[stageState.minoList.length - 3].position,\n        stageState.minoList[stageState.minoList.length - 2].position,\n        stageState.minoList[stageState.minoList.length - 1].position,\n      ];\n      if (\n        stageState.map[(currentPos[0].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[0].x - baseX.value) / Constants.BLOCK_SIZE\n        ] == 1 ||\n        stageState.map[(currentPos[1].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[1].x - baseX.value) / Constants.BLOCK_SIZE\n        ] == 1 ||\n        stageState.map[(currentPos[2].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[2].x - baseX.value) / Constants.BLOCK_SIZE\n        ] == 1 ||\n        stageState.map[(currentPos[3].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[3].x - baseX.value) / Constants.BLOCK_SIZE\n        ] == 1\n      ) {\n        slideRight();\n        counter++;\n        counter += await collisionToLeftMino();\n      }\n      return counter;\n    };\n    const collisionToRightMino = async () => {\n      let counter = 0;\n      const currentPos: Point[] = [\n        stageState.minoList[stageState.minoList.length - 4].position,\n        stageState.minoList[stageState.minoList.length - 3].position,\n        stageState.minoList[stageState.minoList.length - 2].position,\n        stageState.minoList[stageState.minoList.length - 1].position,\n      ];\n      if (\n        stageState.map[(currentPos[0].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[0].x - baseX.value) / Constants.BLOCK_SIZE\n        ] === 1 ||\n        stageState.map[(currentPos[1].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[1].x - baseX.value) / Constants.BLOCK_SIZE\n        ] === 1 ||\n        stageState.map[(currentPos[2].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[2].x - baseX.value) / Constants.BLOCK_SIZE\n        ] === 1 ||\n        stageState.map[(currentPos[3].y - baseY) / Constants.BLOCK_SIZE + 2][\n          (currentPos[3].x - baseX.value) / Constants.BLOCK_SIZE\n        ] === 1\n      ) {\n        slideLeft();\n        counter++;\n        counter += await collisionToRightMino();\n      }\n      return counter;\n    };\n\n    const slideLeft = () => {\n      let length = stageState.minoList.length;\n      for (let i = 0; i < 4; i++)\n        stageState.minoList[length - (i + 1)].slideLeft();\n    };\n\n    const slideRight = () => {\n      let length = stageState.minoList.length;\n      for (let i = 0; i < 4; i++)\n        stageState.minoList[length - (i + 1)].slideRight();\n    };\n\n    const drop = (minoList: MinoModel[]) => {\n      let length = minoList.length;\n      if (length != 0) {\n        for (let i = 0; i < 4; i++) minoList[length - (i + 1)].drop();\n      }\n    };\n\n    const rotateRight = () => {\n      let length = stageState.minoList.length;\n      if (stageState.minoList[length - 4].name != \"O\") {\n        for (let i = 0; i < 4; i++) {\n          stageState.minoList[length - (4 - i)].position = new Point(\n            stageState.minoList[length - 4].position.x -\n              stageState.minoList[length - (4 - i)].shape[i].y *\n                Constants.BLOCK_SIZE,\n            stageState.minoList[length - 4].position.y +\n              stageState.minoList[length - (4 - i)].shape[i].x *\n                Constants.BLOCK_SIZE\n          );\n          stageState.minoList[length - (4 - i)].shape[i] = new Point(\n            -1 * stageState.minoList[length - (4 - i)].shape[i].y,\n            stageState.minoList[length - (4 - i)].shape[i].x\n          );\n        }\n      }\n    };\n    const rotateLeft = () => {\n      let length = stageState.minoList.length;\n      if (stageState.minoList[length - 4].name != \"O\") {\n        for (let i = 1; i < 4; i++) {\n          stageState.minoList[length - (4 - i)].position = new Point(\n            stageState.minoList[length - 4].position.x +\n              stageState.minoList[length - (4 - i)].shape[i].y *\n                Constants.BLOCK_SIZE,\n            stageState.minoList[length - 4].position.y -\n              stageState.minoList[length - (4 - i)].shape[i].x *\n                Constants.BLOCK_SIZE\n          );\n          stageState.minoList[length - (4 - i)].shape[i] = new Point(\n            stageState.minoList[length - (4 - i)].shape[i].y,\n            -1 * stageState.minoList[length - (4 - i)].shape[i].x\n          );\n        }\n      }\n    };\n\n    const resetPosition = (lastPos: Point[], lastShape: Point[]) => {\n      let length = stageState.minoList.length;\n      for (let i = 0; i < 4; i++) {\n        stageState.minoList[length - (4 - i)].position = lastPos[i];\n        stageState.minoList[length - (4 - i)].shape[i] = lastShape[i];\n      }\n    };\n\n    const isI = (name: string) => {\n      return name === \"I\" ? true : false;\n    };\n\n    const resetRotate = (\n      counterW: number,\n      counterM: number,\n      lastPos: Point[],\n      lastShape: Point[]\n    ) => {\n      let length = stageState.minoList.length;\n      if (\n        (isI(stageState.minoList[length - 4].name)\n          ? counterM > 2\n          : counterM > 1) ||\n        stageState.minoList[length - 1].position.x < baseX.value ||\n        stageState.minoList[length - 2].position.x < baseX.value ||\n        stageState.minoList[length - 3].position.x < baseX.value ||\n        stageState.minoList[length - 4].position.x < baseX.value ||\n        stageState.minoList[length - 1].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9 ||\n        stageState.minoList[length - 2].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9 ||\n        stageState.minoList[length - 3].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9 ||\n        stageState.minoList[length - 4].position.x >\n          baseX.value + Constants.BLOCK_SIZE * 9\n      ) {\n        resetPosition(lastPos, lastShape);\n        return true;\n      }\n      return false;\n    };\n\n    const superRotateRight = async () => {\n      const length = stageState.minoList.length;\n      let lastPos = [\n        stageState.minoList[length - 4].position,\n        stageState.minoList[length - 3].position,\n        stageState.minoList[length - 2].position,\n        stageState.minoList[length - 1].position,\n      ];\n      let lastShape: Point[] = [\n        stageState.minoList[length - 4].shape[0],\n        stageState.minoList[length - 3].shape[1],\n        stageState.minoList[length - 2].shape[2],\n        stageState.minoList[length - 1].shape[3],\n      ];\n      rotateRight();\n      if (isBottom(stageState.minoList)) {\n        resetPosition(lastPos, lastShape);\n        return;\n      }\n      const counterW = await collisionToWall();\n      let counterL = await collisionToLeftMino();\n      if (resetRotate(counterW, counterL, lastPos, lastShape)) rotateRight();\n      const counterR = await collisionToRightMino();\n      resetRotate(counterW, counterR, lastPos, lastShape);\n    };\n\n    const superRotateLeft = async () => {\n      const length = stageState.minoList.length;\n      let lastPos = [\n        stageState.minoList[length - 4].position,\n        stageState.minoList[length - 3].position,\n        stageState.minoList[length - 2].position,\n        stageState.minoList[length - 1].position,\n      ];\n      let lastShape: Point[] = [\n        stageState.minoList[length - 4].shape[0],\n        stageState.minoList[length - 3].shape[1],\n        stageState.minoList[length - 2].shape[2],\n        stageState.minoList[length - 1].shape[3],\n      ];\n      rotateLeft();\n      if (isBottom(stageState.minoList)) {\n        resetPosition(lastPos, lastShape);\n        return;\n      }\n      const counterW = await collisionToWall();\n      let counterR = await collisionToRightMino();\n      if (resetRotate(counterW, counterR, lastPos, lastShape)) rotateLeft();\n      const counterL = await collisionToLeftMino();\n      resetRotate(counterW, counterL, lastPos, lastShape);\n    };\n\n    const deleteLine = () => {\n      let score_counter = 0;\n      let isFillLine = false;\n      for (let i = 2; i < stageState.map.length; i++) {\n        let sum = 0;\n        for (let j = 0; j < stageState.map[i].length; j++)\n          sum += stageState.map[i][j];\n        if (sum === 10) {\n          stageState.deleteLineNum++;\n          score_counter++;\n          isFillLine = true;\n          for (let k = stageState.minoList.length - 1; k >= 0; k--) {\n            let y = stageState.minoList[k].position.y;\n            let deleteLine = baseY + (i - 2) * Constants.BLOCK_SIZE;\n            if (y === deleteLine) {\n              stageState.minoList.splice(k, 1);\n            } else if (y < deleteLine) {\n              stageState.minoList[k].drop();\n            }\n          }\n          record();\n          if (\n            stageState.deleteLineNum % 5 === 0 &&\n            Math.ceil(stageState.deleteLineNum / 5) < 30\n          )\n            stageState.level = Math.ceil(stageState.deleteLineNum / 5) + 1;\n        }\n      }\n      if (!isFillLine) stageState.ren = 0;\n      else stageState.ren++;\n      stageState.totalScore += score_counter * score_counter * 100;\n      stageState.totalScore +=\n        score_counter * score_counter * stageState.ren * 20;\n      score_counter = 0;\n    };\n\n    const setGhost = () => {\n      const length = stageState.minoList.length;\n      stageState.ghost = JSON.parse(JSON.stringify([]));\n      for (let i = 0; i < 4; i++) {\n        let x = stageState.minoList[length - (i + 1)].position.x;\n        let y = stageState.minoList[length - (i + 1)].position.y;\n        const name = stageState.minoList[length - (i + 1)].name;\n        const shape = JSON.parse(\n          JSON.stringify(stageState.minoList[length - (i + 1)].shape)\n        );\n        const color = Constants.COLORS[name];\n        const opacity = \"0.3\";\n        stageState.ghost.push(new MinoModel(x, y, name, color, shape, opacity));\n      }\n      while (!isBottom(stageState.ghost) && !isCollision(stageState.ghost))\n        drop(stageState.ghost);\n    };\n\n    ///////////////////////////初期ミノセット\n    for (let i = 0; i < 4; i++) drawMino();\n    shiftStock();\n    alignStock();\n    setGhost();\n    //////////////////////////////////////\n    // 描画フレームごとに呼ばれる処理\n    useAnimationFrame(() => {\n      if (stageState.map[1][4] === 1) {\n        return false;\n      }\n      // if (stageState.healthCheckTime % 2000 === 0) {\n      //   scoreTransfer.healthCheck();\n      //   stageState.healthCheckTime = 0;\n      // }\n      if (\n        stageState.t % (46 - Math.floor(1.5 * stageState.level)) === 0 || //最大30レベル\n        forceRefresh\n      ) {\n        if (isBottom(stageState.minoList) || isCollision(stageState.minoList)) {\n          record();\n          deleteLine();\n          // console.log(\"REN\", stageState.ren);\n          // console.log(\"SCORE\", stageState.totalScore);\n          mapEmit();\n          shiftStock();\n          alignStock();\n          setGhost();\n          canHold = true;\n          ctx.emit(\"score\", stageState.totalScore);\n        } else {\n          drop(stageState.minoList);\n          setGhost();\n        }\n        if (forceRefresh) {\n          forceRefresh = false;\n          stageState.t = 0;\n        }\n      }\n      stageState.t++;\n      stageState.healthCheckTime++;\n      return true;\n    });\n\n    const mapEmit = () => {\n      ctx.emit(\"map\", stageState.map);\n      ctx.emit(\"level\", stageState.level);\n    };\n\n    const adoptMinoPosToWindow = () => {\n      const newBaseX =\n        Math.floor(0.5 * window.innerWidth) - 5 * Constants.BLOCK_SIZE;\n      for (let i = 0; i < stageState.minoList.length; i++) {\n        stageState.minoList[i].resize(newBaseX - baseX.value);\n      }\n      for (let i = 0; i < stageState.holdMino.length; i++) {\n        stageState.holdMino[i].resize(newBaseX - baseX.value);\n      }\n      for (let i = 0; i < stageState.ghost.length; i++) {\n        stageState.ghost[i].resize(newBaseX - baseX.value);\n      }\n      for (let i = 0; i < stageState.stock.length; i++) {\n        stageState.stock[i].resize(newBaseX - baseX.value);\n      }\n      baseX.value = newBaseX;\n    };\n\n    onMounted(() => {\n      window.addEventListener(\"resize\", adoptMinoPosToWindow);\n    });\n\n    return {\n      baseX,\n      drawMino,\n      hold,\n      stageState,\n      mapEmit,\n    };\n  },\n});\n","import { render } from \"./Mino.vue?vue&type=template&id=1f1d4de8&scoped=true&ts=true\"\nimport script from \"./Mino.vue?vue&type=script&lang=ts\"\nexport * from \"./Mino.vue?vue&type=script&lang=ts\"\n\nimport \"./Mino.vue?vue&type=style&index=0&id=1f1d4de8&scoped=true&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\S142575\\\\Documents\\\\self-study\\\\vue3-tetris\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1f1d4de8\"]])\n\nexport default __exports__","\nimport { defineComponent, onMounted, reactive, ref } from \"vue\";\nimport { Block } from \"./Block\";\nimport { useAnimationFrame } from \"../core/useAnimationFrame\";\nimport { MinoModel } from \"../core/MinoModel\";\nimport Constants from \"../core/Constants\";\nimport MinoLayer from \"./Mino.vue\";\n\n/**\n * レイヤーの状態を管理する型\n */\ntype StageState = {\n  map: number[][];\n  wallList: MinoModel[];\n  t: number;\n};\n\nexport default defineComponent({\n  name: \"PlayBoardLayer\",\n  components: { Block, MinoLayer },\n  props: {},\n  setup(props, ctx) {\n    // state: レイヤーの状態\n    const stageState = reactive<StageState>({\n      map: [\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n      ],\n      wallList: [],\n      t: 0,\n    });\n    const getMap = (map: number[][]) => {\n      stageState.map = map;\n    };\n    let baseX1 = ref(\n      Math.floor(0.5 * window.innerWidth) - 6 * Constants.BLOCK_SIZE\n    );\n    let baseX2 = ref(\n      Math.floor(0.5 * window.innerWidth) + 5 * Constants.BLOCK_SIZE\n    );\n    const buildWall = () => {\n      let y1 = 2 * Constants.BLOCK_SIZE;\n      let y2 = 22 * Constants.BLOCK_SIZE;\n      let j = 0;\n      for (let i = 0; i < 21; i++) {\n        stageState.wallList.push(\n          new MinoModel(\n            baseX1.value,\n            y1 + i * Constants.BLOCK_SIZE,\n            \"wall\",\n            \"128,128,128\",\n            []\n          )\n        );\n        stageState.wallList.push(\n          new MinoModel(\n            baseX2.value,\n            y1 + i * Constants.BLOCK_SIZE,\n            \"wall\",\n            \"128,128,128\",\n            []\n          )\n        );\n        if (j < 10) {\n          stageState.wallList.push(\n            new MinoModel(\n              baseX1.value + (j + 1) * Constants.BLOCK_SIZE,\n              y2,\n              \"wall\",\n              \"128, 128, 128\",\n              []\n            )\n          );\n          j++;\n        }\n      }\n    };\n\n    let totalScore = ref(0);\n\n    const updateScore = (score: number) => {\n      totalScore.value = score;\n    };\n\n    let level = ref(1);\n\n    const setLevel = (lv: number) => {\n      level.value = lv;\n    };\n\n    // 描画フレームごとに呼ばれる処理。\n    buildWall();\n    console.log(\"Game Start\");\n    useAnimationFrame(() => {\n      if (stageState.map[1][4] === 1) {\n        console.log(\"Game Over\");\n        ctx.emit(\"ending\", true);\n        ctx.emit(\"score\", totalScore.value);\n        return false;\n      }\n      // trueを返すとunmountまでの間繰り返し呼ばれる\n      return true;\n    });\n\n    const adoptMinoPosToWindow = () => {\n      const newBaseX1 =\n        Math.floor(0.5 * window.innerWidth) - 6 * Constants.BLOCK_SIZE;\n      for (let i = 0; i < stageState.wallList.length; i++) {\n        stageState.wallList[i].resize(newBaseX1 - baseX1.value);\n      }\n      baseX1.value = newBaseX1;\n    };\n\n    onMounted(() => {\n      window.addEventListener(\"resize\", adoptMinoPosToWindow);\n    });\n\n    return {\n      baseX1,\n      baseX2,\n      stageState,\n      getMap,\n      totalScore,\n      updateScore,\n      level,\n      setLevel,\n    };\n  },\n});\n","import { render } from \"./PlayBoardLayer.vue?vue&type=template&id=3abde733&scoped=true&ts=true\"\nimport script from \"./PlayBoardLayer.vue?vue&type=script&lang=ts\"\nexport * from \"./PlayBoardLayer.vue?vue&type=script&lang=ts\"\n\nimport \"./PlayBoardLayer.vue?vue&type=style&index=0&id=3abde733&scoped=true&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\S142575\\\\Documents\\\\self-study\\\\vue3-tetris\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3abde733\"]])\n\nexport default __exports__","\nimport { defineComponent, ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport PlayBoardLayer from \"../components/PlayBoardLayer.vue\";\nimport ScoreTransfer from \"../infrastructure/transfer/ScoreTransfer\";\n\nexport default defineComponent({\n  name: \"Stage\",\n  components: {\n    PlayBoardLayer,\n  },\n  props: {\n    maxFish: { type: Number, default: 50 },\n  },\n  setup() {\n    let flag = ref(false);\n    let score = ref(0);\n    let userName = ref(\"\");\n    const router = useRouter();\n    const scoreTransfer = new ScoreTransfer();\n    const ending = (end: boolean) => {\n      if (end) flag.value = true;\n    };\n    const resultScore = (result: number) => {\n      score.value = result;\n    };\n    const sendScore = async (name: string, value: number) => {\n      return await scoreTransfer.sendScore(name, value);\n    };\n    const moveToRanking = async () => {\n      await sendScore(userName.value, score.value);\n      return router.replace({ name: \"Ranking\" });\n    };\n    const moveToTop = () => {\n      return router.replace({ name: \"Top\" });\n    };\n    return {\n      flag,\n      score,\n      userName,\n      ending,\n      resultScore,\n      moveToRanking,\n      moveToTop,\n    };\n  },\n});\n","import { render } from \"./Stage.vue?vue&type=template&id=401db482&scoped=true&ts=true\"\nimport script from \"./Stage.vue?vue&type=script&lang=ts\"\nexport * from \"./Stage.vue?vue&type=script&lang=ts\"\n\nimport \"./Stage.vue?vue&type=style&index=0&id=401db482&scoped=true&lang=scss\"\n\nimport exportComponent from \"C:\\\\Users\\\\S142575\\\\Documents\\\\self-study\\\\vue3-tetris\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-401db482\"]])\n\nexport default __exports__"],"names":["_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","_createStaticVNode","_hoisted_6","key","class","_hoisted_7","_hoisted_8","_createElementVNode","_hoisted_9","_hoisted_10","render","_ctx","_cache","$props","$setup","$data","$options","_component_PlayBoardLayer","_resolveComponent","_openBlock","_createElementBlock","_Fragment","_createVNode","onEnding","ending","onScore","resultScore","flag","_toDisplayString","score","_createTextVNode","_withDirectives","$event","userName","_vModelText","onClick","args","moveToTop","id","moveToRanking","_hoisted_2","_hoisted_3","_hoisted_4","_component_Block","_component_MinoLayer","_renderList","stageState","wallList","blockProps","_createBlock","x","position","y","angle","color","onMap","getMap","updateScore","onLevel","setLevel","level","totalScore","Block","props","style","h","useAnimationFrame","onFire","isTerminated","onMounted","tick","requestAnimationFrame","shouldContinue","onBeforeUnmount","_defineProperty","obj","value","Object","defineProperty","enumerable","configurable","writable","Point","constructor","this","length","Math","sqrt","rad2angle","r","PI","atan2","add","p","sub","times","unit","unitLength","len","limit","maxLength","rotate","deg","angle2rad","a","rad","l","cos","sin","Constants","T","I","L","J","O","S","Z","DEFAULT_FORCE","instanseCount","randomName","floor","random","MinoModel","name","shape","opacity","update","vec","drop","slideLeft","slideRight","slideUp","setForce","force","resize","difference","ghost","block","scale","minoList","holdMino","stock","useKeyDown","handler","targetDom","onKeyDown","ev","target","document","body","addEventListener","onUnmounted","removeEventListener","defineComponent","components","keyInput","type","String","default","setup","ctx","ref","reactive","map","t","healthCheckTime","JSON","parse","stringify","ren","deleteLineNum","forceRefresh","canHold","baseX","window","innerWidth","baseY","record","Array","fill","mino","refill_mino_name","push","minoNamePopper","res","splice","drawMino","i","hold","temp","shift","shiftStock","alignStock","index","isBottom","isCollision","async","event","collisionToWall","collisionToLeftMino","setGhost","collisionToRightMino","emit","superRotateRight","superRotateLeft","counter","currentPos","rotateRight","rotateLeft","resetPosition","lastPos","lastShape","isI","resetRotate","counterW","counterM","counterL","counterR","deleteLine","score_counter","isFillLine","sum","j","k","ceil","mapEmit","adoptMinoPosToWindow","newBaseX","__exports__","MinoLayer","baseX1","baseX2","buildWall","y1","y2","lv","console","log","newBaseX1","PlayBoardLayer","maxFish","Number","router","useRouter","scoreTransfer","ScoreTransfer","end","result","sendScore","replace"],"sourceRoot":""}